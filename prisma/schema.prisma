datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id       String   @id @default(cuid())
  email    String   @unique
  name     String?
  password String?
  provider Provider
  role     Role     @default(user)
  forms    Form[]   @relation("user")
}

model Template {
  id           String   @id @default(cuid())
  name         String
  description  String?
  previewImage String?
  theme        String?
  fontFamily   String?
  screens      Screen[] @relation("templateScreens")
}

model Form {
  id         String   @id @default(cuid())
  name       String?
  published  Boolean  @default(false)
  theme      String?
  fontFamily String?
  screens    Screen[]
  userId     String?
  user       User?    @relation(fields: [userId], references: [id], name: "user", onDelete: Cascade)

  formResponses FormResponse[]
}

model FormResponse {
  id           String   @id @default(cuid())
  form         Form     @relation(fields: [formId], references: [id], onDelete: Cascade)
  formId       String
  submittedAt  DateTime @default(now())
  responseData Json
}

model Screen {
  id          String     @id @default(cuid())
  type        ScreenType
  title       String
  description String?
  buttonText  String?
  scale       Int?
  order       Int?
  required    Boolean    @default(false)
  form        Form?       @relation(fields: [formId], references: [id], onDelete: Cascade)
  formId      String?
  template    Template?  @relation(fields: [templateId], references: [id], name: "templateScreens", onDelete: Cascade)
  templateId  String?
  rightLabel  String?
  leftLabel   String?
  options     Option[]
}

model Option {
  id       String  @id @default(cuid())
  label    String
  value    String
  imageUrl String?
  screen   Screen  @relation(fields: [screenId], references: [id], onDelete: Cascade)
  screenId String
}

enum ScreenType {
  welcomeScreen
  short_text
  long_text
  multiple_choice
  dropdown
  date
  rating
  boolean
  email
  website
  file_upload
  number
  opinion_scale
  picture_choice
  endScreen
}

enum Provider {
  Google
  Credentials
}

enum Role {
  user
  admin
}
